version: 3

dotenv: 
- env

vars:

  V: p2
  
  OP:
    sh: echo "{{.V}}"

  OE:
    sh: echo "$V"


env:
  V: e2
  
  OE:
    sh: echo "$V"

  OP:
    sh: echo "{{.V}}"

  E: 3

  S:
    sh: echo ${SS:-3}

tasks:
  
  simple:
    silent: true
    desc: order
    cmds:
    - echo eV=$V pV={{.V}}

  inner:
    silent: true
    desc: order
    cmds:
    - echo eV=$V pV={{.V}}
    vars:
      V: p3
    env:
      V: e3

  prio:
    desc: priority
    cmds:
    - echo pOP={{.OP}} pOE={{.OE}}  eOE=$OE eOP=$OP

  env:
    desc: env
    cmds:
    - echo E=$E EE=$EE

  saved:
    desc: saved
    cmds:
    - echo S=$S SS=$SS SSS=$SSS overriden SS=${SS:-5}
    env:
      SSS:
        sh: echo ${SS:-4}
